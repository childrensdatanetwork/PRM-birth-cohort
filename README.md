# PRM-birth-cohort

Following the steps below can guide you through cross validation of the CA PRM birth model using your birth records and CPS records. 

### Step 1: Birth data prep
Prepare birth data by constructing those variables below.

| Variable Name | Description                                | Original Model Coding                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ------------- | ------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| bid           | birth id                                   | Â If not available, just a unique number for each child                                                                                                                                                                                                                                                                                                                                                                                                     |
| sex           | child's sex                                | 1=male, 2=female, 9=missing                                                                                                                                                                                                                                                                                                                                                                                                                                |
| mage          | maternal age at birth                      | missing = 99                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| fbthdate      | paternal birth date                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| fage          | paternal age at birth                      | missing=99                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| feduc         | paternal education                         | 0=No formal education, 1=8th grade or less, 2=9th grade through 12th grade - no diploma, 3=High school graduate or GED completed, 4=Some college credit - no degree, 5=Associate degree, 6=Bachelor's degree, 7=Master's degree, 8=Doctorate or professional degree, 9=unknown or not stated.                                                                                                                                                              |
| fracecodem    | paternal multi-race code                   | 1=White only, 2=Black only, 3=American Indian/Alaskan native only, 4=Asian only, 5=Hawaiian/PI only, 6=other, 7=two or more race categories, 9=missing                                                                                                                                                                                                                                                                                                     |
| fsporig       | paternal ethnicity hispanic/latino         | 2=yes, 1=no, 9=missing                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| meduc         | maternal education                         | 0=No formal education, 1=8th grade or less, 2=9th grade through 12th grade - no diploma, 3=High school graduate or GED completed, 4=Some college credit - no degree, 5=Associate degree, 6=Bachelor's degree, 7=Master's degree, 8=Doctorate or professional degree, 9=unknown or not stated.                                                                                                                                                              |
| mracecodem    | maternal multi-race code                   | 1=White only, 2=Black only, 3=American Indian/Alaskan native only, 4=Asian only, 5=Hawaiian/PI only, 6=other, 7=two or more race categories, 9=missing                                                                                                                                                                                                                                                                                                     |
| msporig       | maternal ethnicity hispanic/latina         | 2=yes, 1=no, 9=missing                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| precare       | prenatal care                              | 1=yes, NA=no                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| mfood         | WIC food                                   | "Y"=yes, "U"=miss                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| prevlbl       | number of previous birth live              | 99=unknown/missing                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| prevlbd       | number of previous birth dead              | 99=unknown/missing                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| paymsopc      | birth payment method for delivery          | 2=medicaid, 7=private, 9=self pay, 99=miss, (other types can be in any numbers other than 2,7,9 NA, 99)                                                                                                                                                                                                                                                                                                                                                    |
| probl\_1      | pre-pregnancy problems                     | pre-pregnancy diabetes: 09, gestational diabetes: 31, pre-pregnancy hypertension: 03,<br>gestational hypertension: 01, previos pre-term birth: 23, previous poor pregnancy outcomes: 36<br>#vaginal bleeding: ?, pregnancy resulted from infertility treatment: 40-41, gonorrhea: 43, syphilis: 46, herpes: 16, chlamydia: 42, hepatitis b: 18, hepatitis c: 45, cervical cerclage: 24, tocolysis: 28, external cephalic version failed: 38,               |
| probl\_2      | onset of labor problems                    | premature rupture: 10, precipitous labor: 07, prolonged labor: 08, induction: 11, augmentation: 12, non-vertex: 32, steroids: 33, antibiotics: 34, chramnionitis: 35,<br>meconium: 19, fetal intoler: 36, anesthesia: 37, transfusion: 24, prenineal: 40, rupture uterus: 41, unplaneed hysterectomy: 42,<br>intense care: 43, unplaned operation: 44                                                                                                      |
| mdel          | method of delivery - cesarean              | yes = 1, no=0                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fetlbth       | fetal presentation                         | cephalic: 2, breech: 3, other: 4, unknown: 9                                                                                                                                                                                                                                                                                                                                                                                                               |
| bthweight     | child birth weight                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| obstegest     | obstetric estimate of gestation at deliver | in weeks                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| probl\_3      | code abnormal conditions of child          | assisted ventilation: 71, assisted ventilation gt6: 85, nicu: 73, surfactant therapy: 86,<br>antibiotics: 87, seizures: 70, anencephaly: 01, mening: 02, cyanotic cong heart disease: 76, diaphrag hernya: 77, omphalocele: 78<br>gasthrochisis: 79, limd reduction: 80, cleft palate: 28, cleft lip: 29, down syndrome conf: 57,<br>down syndrome pending: 81, suspected chrom disorder conf: 82, suspected chrom disorder pending: 83<br>hyposdapias: 35 |

### Step 2: Link CPS records
Link your CPS records to this birth dataset at the child level. You need the first placement start date ('PE_S_DT' in "%Y%m%d" format) and a child's birth date ('BIRTH_DT').

Additionally, create the below variables from CPS data. As they are for further analysis, skip this process if you don't have the information.

| Variables from CPS records                      |
| ----------------------------------------------- |
| (1) investigated (yes=1 / no=0)                     |
| (2) date of first ever investigation            |
| (3) substantiated (yes=1 / no=0)                     |
| (4) date of first ever substantiation           |
| (5) placed in foster care (yes=1 / no=0)            |
| (6) date of first ever placement in foster care |
| (7) date of first ever referral if possible     |

### Step 2
Download all the files in the same folder.
Then, run 'PRM_coding_features_cleaned_Dec2021.R'. This creates predicting and target features.
Don't forget to change 'setwd("working directory")' to your current working directory.

### Step 3
Run 'scoreNewDatasetCAModel_Mar2022.R' to generate prediction scores for each child. Again, change 'setwd("working directory")' to your current working directory.
