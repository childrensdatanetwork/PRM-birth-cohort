# PRM-birth-cohort

Following the steps below can guide you through cross validation of the CA PRM birth model using your birth records and CPS records. 

### Step 1: Birth data preparation
Prepare birth data by constructing the variables below.

| Variable Name | Description                                | Original Model Coding                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ------------- | ------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| bid           | birth id                                   | Â If not available, just a unique number for each child                                                                                                                                                                                                                                                                                                                                                                                                     |
| sex           | child's sex                                | 1=male, 2=female, 9=missing                                                                                                                                                                                                                                                                                                                                                                                                                                |
| mage          | maternal age at birth                      | 99=missing                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| fbthdate      | paternal birth date                        | NA=missing                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| fage          | paternal age at birth                      | 99=missing                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| feduc         | paternal education                         | 0=No formal education, 1=8th grade or less, 2=9th grade through 12th grade - no diploma, 3=High school graduate or GED completed, 4=Some college credit - no degree, 5=Associate degree, 6=Bachelor's degree, 7=Master's degree, 8=Doctorate or professional degree, 9=unknown or not stated.                                                                                                                                                              |
| fracecodem    | paternal multi-race code                   | 1=White only, 2=Black only, 3=American Indian/Alaskan native only, 4=Asian only, 5=Hawaiian/PI only, 6=other, 7=two or more race categories, 9=missing                                                                                                                                                                                                                                                                                                     |
| fsporig       | paternal ethnicity hispanic/latino         | 2=yes, 1=no, 9=missing                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| meduc         | maternal education                         | 0=No formal education, 1=8th grade or less, 2=9th grade through 12th grade - no diploma, 3=High school graduate or GED completed, 4=Some college credit - no degree, 5=Associate degree, 6=Bachelor's degree, 7=Master's degree, 8=Doctorate or professional degree, 9=unknown or not stated.                                                                                                                                                              |
| mracecodem    | maternal multi-race code                   | 1=White only, 2=Black only, 3=American Indian/Alaskan native only, 4=Asian only, 5=Hawaiian/PI only, 6=other, 7=two or more race categories, 9=missing                                                                                                                                                                                                                                                                                                     |
| msporig       | maternal ethnicity hispanic/latina         | 2=yes, 1=no, 9=missing                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| precare       | prenatal care                              | 1=yes, NA=no                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| mfood         | WIC food                                   | "Y"=yes, "U"=miss                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| prevlbl       | number of previous birth live              | 99=unknown/missing                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| prevlbd       | number of previous birth dead              | 99=unknown/missing                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| paymsopc      | birth payment method for delivery          | 2=medicaid, 7=private, 9=self pay, 99=miss, (other types can be in any numbers other than 2,7,9 NA, 99)                                                                                                                                                                                                                                                                                                                                                    |
| probl\_1      | pre-pregnancy problems                     | "09"=pre-pregnancy diabetes, "31"=gestational diabetes, "03"=pre-pregnancy hypertension,<br>"01"=gestational hypertension, "23"=previos pre-term birth, "36"=previous poor pregnancy outcomes<br>#"40"/"41"=pregnancy resulted from infertility treatment, "43"=gonorrhea, "46"=syphilis, "16"=herpes, "42"=chlamydia, "18"=hepatitis b, "45"=hepatitis c, "24"=cervical cerclage, "28"=tocolysis, "38"=external cephalic version failed               |
| probl\_2      | onset of labor problems                    | "10"=premature rupture, "07"=precipitous labor, "08"=prolonged labor, "11"=induction, "12"=augmentation, "32"=non-vertex, "33"=steroids, "34"=antibiotics, "35"=chramnionitis,<br>"19"=meconium, "36"=fetal intoler, "37"=anesthesia, "24"=transfusion, "40"=prenineal, "41"=rupture uterus, "42"=unplaneed hysterectomy,<br>"43"=intense care, "44"=unplaned operation: 44                                                                                                      |
| mdel          | method of delivery - cesarean              | 1=yes, 0=no                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fetlbth       | fetal presentation                         | 2=cephalic, 3=breech, 4=other, 9=unknown                                                                                                                                                                                                                                                                                                                                                                                                               |
| bthweight     | child birth weight                         | numeric in grams, NA/9999=missing                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| obstegest     | obstetric estimate of gestation at deliver | numeric in weeks, NA=missing                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| probl\_3      | code abnormal conditions of child          | "71"=assisted ventilation, "85"=assisted ventilation gt6, "73"=nicu, "86"=surfactant therapy,<br>"87"=antibiotics, "70"=seizures, "01"=anencephaly, "02"=mening, "76"=cyanotic cong heart disease, "77"=diaphrag hernya, "78"=omphalocele<br>"79"=gasthrochisis, "80"=limd reduction, "28"=cleft palate, "29"=cleft lip, "57"=down syndrome conf,<br>"81"=down syndrome pending, "82"=suspected chrom disorder conf, "83"=suspected chrom disorder pending,<br>"35"=hyposdapias |

### Step 2: Link CPS records
Link your CPS records to this birth dataset at the child level. You need the first placement start date ('PE_S_DT' in "%Y%m%d" format) and a child's birth date ('BIRTH_DT').

Additionally, create the below variables from CPS data. As they are for further analysis, skip this process if you don't have the information.

| Variables from CPS records                      |
| ----------------------------------------------- |
| (1) investigated (1=yes / 0=no)                     |
| (2) date of first ever investigation            |
| (3) substantiated (1=yes / 0=no)                     |
| (4) date of first ever substantiation           |
| (5) placed in foster care (1=yes / 0=no)             |
| (6) date of first ever placement in foster care |
| (7) date of first ever referral if possible     |

### Step 3: Download all the files in the same folder.
Then, run 'PRM_coding_features_cleaned_Dec2021.R'. This creates predicting and target features.
Don't forget to change 'setwd("working directory")' to your current working directory.

### Step 4: Run 'scoreNewDatasetCAModel_Mar2022.R.' 
This is to generate prediction scores for each child. Again, change 'setwd("working directory")' to your current working directory.
